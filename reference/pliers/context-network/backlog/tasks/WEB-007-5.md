# WEB-007-5: Password Authentication Flow

## Metadata
- **Status:** ready
- **Type:** feature
- **Epic:** web-auth
- **Priority:** high
- **Size:** small
- **Estimated Effort:** 2-3 days
- **Created:** 2025-09-30
- **Parent Task:** WEB-007 (archived - oversized)
- **Branch:** feat/WEB-007-5-password-auth-flow

## Description
Implement traditional password authentication with email and password fields for both login and registration. Includes password strength indicator for registration, password visibility toggle, and form validation.

## Acceptance Criteria
- [ ] Create login form with email and password
- [ ] Build registration form with password confirmation
- [ ] Add password strength indicator for registration
- [ ] Implement password visibility toggle
- [ ] Add form validation and error display

## Technical Notes
- Password strength calculation based on length, complexity
- Show strength as visual indicator (Very Weak â†’ Strong)
- Password visibility toggle for better UX
- Client-side validation before API call

## Implementation Approach
```typescript
const PasswordAuthFlow = ({
  mode,
  onSuccess,
  onError
}: {
  mode: 'login' | 'register';
  onSuccess: (result: any) => void;
  onError: (error: string) => void;
}) => {
  const [formData, setFormData] = useState({
    email: '',
    password: '',
    confirmPassword: ''
  });
  const [passwordStrength, setPasswordStrength] = useState(0);
  const [showPassword, setShowPassword] = useState(false);

  useEffect(() => {
    if (mode === 'register') {
      setPasswordStrength(calculatePasswordStrength(formData.password));
    }
  }, [formData.password, mode]);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();

    try {
      if (mode === 'register') {
        if (formData.password !== formData.confirmPassword) {
          throw new Error('Passwords do not match');
        }
        if (passwordStrength < 3) {
          throw new Error('Please use a stronger password');
        }
      }

      const result = await apiClient.auth.authenticateWithPassword(
        formData.email,
        formData.password,
        mode
      );
      onSuccess(result);
    } catch (error) {
      onError(error.message);
    }
  };

  return (
    <form onSubmit={handleSubmit} className="password-auth-form">
      <h2>{mode === 'register' ? 'Create Account' : 'Sign In'}</h2>

      <FormField>
        <Label>Email</Label>
        <Input
          type="email"
          value={formData.email}
          onChange={(e) => setFormData({ ...formData, email: e.target.value })}
          required
        />
      </FormField>

      <FormField>
        <Label>Password</Label>
        <div className="password-input">
          <Input
            type={showPassword ? 'text' : 'password'}
            value={formData.password}
            onChange={(e) => setFormData({ ...formData, password: e.target.value })}
            required
          />
          <Button
            type="button"
            variant="ghost"
            onClick={() => setShowPassword(!showPassword)}
          >
            {showPassword ? <EyeOff /> : <Eye />}
          </Button>
        </div>
        {mode === 'register' && formData.password && (
          <PasswordStrengthIndicator strength={passwordStrength} />
        )}
      </FormField>

      {mode === 'register' && (
        <FormField>
          <Label>Confirm Password</Label>
          <Input
            type={showPassword ? 'text' : 'password'}
            value={formData.confirmPassword}
            onChange={(e) => setFormData({ ...formData, confirmPassword: e.target.value })}
            required
          />
        </FormField>
      )}

      <Button type="submit">
        {mode === 'register' ? 'Create Account' : 'Sign In'}
      </Button>
    </form>
  );
};
```

## Dependencies
- WEB-007-1: Authentication Context
- WEB-003: API Client (password auth endpoints)
- WEB-002: Design System (form components)

## Follows After
- WEB-007-2: Authentication Method Selector

## Enables
- Traditional password-based authentication

## Testing Strategy
- Unit tests for password strength calculation
- Test form validation
- Verify password confirmation matching
- Test visibility toggle
- Verify error handling

## Success Metrics
- Forms validate input correctly
- Password strength indicator displays
- Visibility toggle works
- Authentication succeeds with valid credentials
- Errors display appropriately

## Branch Naming
`feat/WEB-007-5-password-auth-flow`