# WEB-005-3: Form Canvas and Field Management

## Metadata
- **Status:** ready
- **Type:** feature
- **Epic:** web-forms
- **Priority:** high
- **Size:** medium
- **Estimated Effort:** 3-5 days
- **Created:** 2025-09-30
- **Parent Task:** WEB-005 (archived - oversized)
- **Branch:** feat/WEB-005-3-form-canvas-field-management

## Description
Build the form canvas area where fields can be dropped, displayed, reordered, and managed. Implement drag-and-drop for field placement and reordering, field selection, and basic field actions (delete, duplicate). This is the core interaction area of the form designer.

## Acceptance Criteria
- [ ] Implement drop zone for receiving fields from palette
- [ ] Create sortable field list with drag handles
- [ ] Add field selection and highlighting
- [ ] Implement field delete and duplicate actions
- [ ] Display empty state when no fields exist

## Technical Notes
- Use @dnd-kit's SortableContext for field reordering
- Integrate with FormDesignerContext for state management
- Each field should display a preview using FormRenderer
- Handle both dropping new fields and reordering existing ones

## Implementation Approach
```typescript
const FormCanvas = ({ schema }: { schema: FormSchema }) => {
  const { addField, updateFieldOrder, deleteField, duplicateField } = useFormDesigner();

  const handleDrop = (item: FieldType) => {
    addField(createFieldFromType(item));
  };

  return (
    <div className="form-canvas">
      <FormMetadataEditor schema={schema} />

      <DndContext onDragEnd={handleDragEnd}>
        <SortableContext items={schema.fields.map(f => f.id)}>
          {schema.fields.map((field) => (
            <SortableFieldItem
              key={field.id}
              field={field}
              onDelete={() => deleteField(field.id)}
              onDuplicate={() => duplicateField(field.id)}
            />
          ))}
        </SortableContext>
      </DndContext>

      {schema.fields.length === 0 && <EmptyCanvasState />}
    </div>
  );
};
```

## Dependencies
- WEB-005-1: Form Designer Foundation (context)
- WEB-005-2: Field Palette Component (drag source)
- WEB-004: Dynamic Form Renderer Engine (field preview)

## Follows After
- WEB-005-1: Form Designer Foundation
- WEB-005-2: Field Palette Component

## Enables
- WEB-005-4: Property Panel and Field Configuration (field selection)

## Testing Strategy
- Unit tests for field management operations
- Integration tests for drag-and-drop from palette
- Test field reordering functionality
- Test field actions (delete, duplicate)
- Verify empty state rendering

## Success Metrics
- Fields can be dropped from palette onto canvas
- Fields can be reordered by dragging
- Field selection works correctly
- Delete and duplicate actions function properly
- Empty state displays when appropriate

## Branch Naming
`feat/WEB-005-3-form-canvas-field-management`