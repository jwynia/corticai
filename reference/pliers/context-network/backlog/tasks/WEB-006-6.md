# WEB-006-6: Data Source Configuration

## Metadata
- **Status:** ready
- **Type:** feature
- **Epic:** web-dashboard
- **Priority:** medium
- **Size:** medium
- **Estimated Effort:** 3-4 days
- **Created:** 2025-09-30
- **Parent Task:** WEB-006 (archived - oversized)
- **Branch:** feat/WEB-006-6-data-source-configuration

## Description
Implement the data source configuration system that allows widgets to fetch data from different sources: form submissions, API endpoints, or analytics data. This includes the configuration UI and data fetching logic.

## Acceptance Criteria
- [ ] Create data source type selector
- [ ] Implement form submissions data source
- [ ] Add API endpoint data source configuration
- [ ] Support refresh interval configuration
- [ ] Implement data transformation/mapping

## Technical Notes
- Data sources use API client from WEB-003
- Form submissions can leverage existing form API
- API endpoint source should allow custom URLs and params
- Support data mapping to normalize different source formats

## Implementation Approach
```typescript
interface DataSourceConfig {
  type: 'form-submissions' | 'api-endpoint' | 'analytics';
  config: any;
  refreshInterval?: number;
  dataMapping?: DataMapping;
}

const DataSourceConfig = ({ widget }: { widget: Widget }) => {
  const [dataSource, setDataSource] = useState(widget.dataSource);

  return (
    <div className="data-source-config">
      <FormField>
        <Label>Data Source Type</Label>
        <Select
          value={dataSource.type}
          onValueChange={(value) =>
            setDataSource({ ...dataSource, type: value })
          }
        >
          <SelectTrigger>
            <SelectValue />
          </SelectTrigger>
          <SelectContent>
            <SelectItem value="form-submissions">Form Submissions</SelectItem>
            <SelectItem value="api-endpoint">API Endpoint</SelectItem>
            <SelectItem value="analytics">Analytics Data</SelectItem>
          </SelectContent>
        </Select>
      </FormField>

      {dataSource.type === 'form-submissions' && (
        <FormSubmissionDataSource
          config={dataSource.config}
          onChange={(config) =>
            setDataSource({ ...dataSource, config })
          }
        />
      )}

      {dataSource.type === 'api-endpoint' && (
        <ApiEndpointDataSource
          config={dataSource.config}
          onChange={(config) =>
            setDataSource({ ...dataSource, config })
          }
        />
      )}

      <FormField>
        <Label>Refresh Interval</Label>
        <Select
          value={dataSource.refreshInterval?.toString()}
          onValueChange={(value) =>
            setDataSource({
              ...dataSource,
              refreshInterval: parseInt(value)
            })
          }
        >
          <SelectTrigger><SelectValue /></SelectTrigger>
          <SelectContent>
            <SelectItem value="0">Manual only</SelectItem>
            <SelectItem value="30">30 seconds</SelectItem>
            <SelectItem value="60">1 minute</SelectItem>
            <SelectItem value="300">5 minutes</SelectItem>
          </SelectContent>
        </Select>
      </FormField>
    </div>
  );
};
```

## Dependencies
- WEB-006-2: Widget Framework and Wrapper (configuration modal)
- WEB-003: API Client Integration (data fetching)

## Follows After
- WEB-006-2: Widget Framework and Wrapper

## Enables
- WEB-006-7: Real-time Widget Updates (refresh mechanism)

## Testing Strategy
- Unit tests for each data source type
- Test data fetching and transformation
- Verify refresh intervals work
- Test error handling for failed requests

## Success Metrics
- Data sources can be configured
- Data fetches correctly from each source type
- Refresh intervals trigger updates
- Error states display appropriately

## Branch Naming
`feat/WEB-006-6-data-source-configuration`