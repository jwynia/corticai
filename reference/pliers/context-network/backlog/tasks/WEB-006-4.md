# WEB-006-4: Metric and Progress Widgets

## Metadata
- **Status:** ready
- **Type:** feature
- **Epic:** web-dashboard
- **Priority:** medium
- **Size:** small
- **Estimated Effort:** 2-3 days
- **Created:** 2025-09-30
- **Parent Task:** WEB-006 (archived - oversized)
- **Branch:** feat/WEB-006-4-metric-progress-widgets

## Description
Implement metric, progress, and gauge widgets for displaying KPIs and progress indicators. Metric widgets show single values with trend indicators, progress widgets show completion percentages, and gauge widgets display values within a range.

## Acceptance Criteria
- [ ] Implement MetricWidget with value and trend
- [ ] Create ProgressWidget with percentage bar
- [ ] Build GaugeWidget with arc visualization
- [ ] Add sparkline support for metrics
- [ ] Support threshold coloring (good/warning/critical)

## Technical Notes
- Use design system typography for metric values
- Trend indicators should show up/down/stable with colors
- Progress bars should support custom colors
- Gauge can use Recharts RadialBarChart or custom SVG

## Implementation Approach
```typescript
const MetricWidget = ({ widget, data }: { widget: Widget; data: any }) => {
  const config = widget.config as MetricConfig;
  const value = extractValue(data, config.valueField);
  const previousValue = extractValue(data, config.previousValueField);
  const change = previousValue ? calculateChange(value, previousValue) : null;
  const trend = change ? (change > 0 ? 'up' : change < 0 ? 'down' : 'stable') : null;

  return (
    <div className="metric-widget">
      <div className="metric-main">
        <div className="metric-value">
          {formatValue(value, config.format)}
        </div>
        <div className="metric-label">{config.label}</div>
      </div>

      {change !== null && (
        <div className={`metric-change ${trend}`}>
          <TrendIcon trend={trend} />
          <span>{formatChange(change, config.format)}</span>
        </div>
      )}

      {config.showSparkline && data.sparklineData && (
        <Sparkline data={data.sparklineData} />
      )}
    </div>
  );
};

const ProgressWidget = ({ widget, data }: { widget: Widget; data: any }) => {
  const config = widget.config as ProgressConfig;
  const value = extractValue(data, config.valueField);
  const percentage = (value / config.max) * 100;

  return (
    <div className="progress-widget">
      <div className="progress-header">
        <span>{config.label}</span>
        <span>{formatValue(value, config.format)} / {config.max}</span>
      </div>
      <div className="progress-bar">
        <div
          className="progress-fill"
          style={{ width: `${percentage}%`, backgroundColor: getProgressColor(percentage) }}
        />
      </div>
    </div>
  );
};
```

## Dependencies
- WEB-006-2: Widget Framework and Wrapper

## Follows After
- WEB-006-2: Widget Framework and Wrapper

## Enables
- KPI dashboard capabilities

## Testing Strategy
- Unit tests for each widget type
- Test trend calculation logic
- Verify threshold coloring
- Test with various data formats

## Success Metrics
- Widgets display values correctly
- Trends calculate and display properly
- Threshold colors apply correctly
- Widgets are visually appealing and readable

## Branch Naming
`feat/WEB-006-4-metric-progress-widgets`